# SP_Ultra_CAP

### 目录内容

此文件夹用以存放超级电容管理板控制代码

### 文件简介

还没有完善注释，我知道你很急，但你先别急

### 文件使用环境

Keil compilerV5.06 update7(build 960)

RT-Thread Studio

### 部分程序框图

高清矢量图请移步Doc文件夹

![](https://raw.githubusercontent.com/Sirius-RX/blogimg/main/img/%E6%95%B0%E6%8D%AE%E9%80%9A%E8%B7%AF.png)

![](https://raw.githubusercontent.com/Sirius-RX/blogimg/main/img/HRPWM%20master%20timer%E5%BF%AB%E9%80%9F%E4%B8%AD%E6%96%AD%E6%B5%81%E7%A8%8B%E5%9B%BE.png)

![](https://raw.githubusercontent.com/Sirius-RX/blogimg/main/img/TIM2_5mS%E4%B8%AD%E6%96%AD%E6%B5%81%E7%A8%8B%E5%9B%BE.png)

### 文件使用方法

以下内容摘自Doc文件夹中技术报告的**软件方面注意事项**内容

l printf重定向了，需要启动MicroLIB；

![](https://raw.githubusercontent.com/Sirius-RX/blogimg/main/img/MicroLIB.png)

l 优化等级不能太低，不然DMA会有问题，未解之谜，优化等级不能低于O2；

![](https://raw.githubusercontent.com/Sirius-RX/blogimg/main/img/%E4%BC%98%E5%8C%96%E7%AD%89%E7%BA%A7.png)

l 注意Define内容不能少，因为启用了Cortex-M4的浮点运算加速，这里附一下Define内容；

 ![](https://raw.githubusercontent.com/Sirius-RX/blogimg/main/img/%E5%85%A8%E5%B1%80Define.png)

l 注意这个工程是有内存分布文件的，因为启动了STM32G474的CCMRAM，将程序存储在这块内存地址上能够加快程序的执行速度。要注意劲量避免将变量存储在CCMRAM内存中，因为这快内存再重定向之前只有内核能够访问，外设都不能访问。附一下内存分布文件，字体使用的Cascadia Code个人很喜欢这个字体。

; *************************************************************

; *** Scatter-Loading Description File generated by uVision ***

; *************************************************************

 

LR_IROM1 0x08000000 0x00080000 {  ; load region size_region

 ER_IROM1 0x08000000 0x00080000 { ; load address = execution address

  *.o (RESET, +First)

  *(InRoot$$Sections)

  .ANY (+RO)

 }

 RW_IRAM1 0x20000000 0x00018000 { ; RW data SRAM1

  .ANY (+RW +ZI)

 }

; RW_IRAM2 0x20018000 0x00002000 { ; RW data SRAM2

;  .ANY (+RW +ZI)

; }

 ER 0x10000000 0x00008000{

 .ANY (ccmram)

 }

}