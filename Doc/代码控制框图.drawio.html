<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=5,IE=9" ><![endif]-->
<!DOCTYPE html>
<html>
<head>
<title>代码控制框图</title>
<meta charset="utf-8"/>
</head>
<body><div class="mxgraph" style="max-width:100%;border:1px solid transparent;" data-mxgraph="{&quot;highlight&quot;:&quot;#0000ff&quot;,&quot;nav&quot;:true,&quot;resize&quot;:true,&quot;toolbar&quot;:&quot;zoom layers tags lightbox&quot;,&quot;edit&quot;:&quot;_blank&quot;,&quot;xml&quot;:&quot;&lt;mxfile host=\&quot;Electron\&quot; modified=\&quot;2023-04-29T03:03:08.021Z\&quot; agent=\&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/21.2.1 Chrome/112.0.5615.87 Electron/24.1.2 Safari/537.36\&quot; etag=\&quot;JDY0egmCwVxgNeDFZg1C\&quot; version=\&quot;21.2.1\&quot; type=\&quot;device\&quot;&gt;\n  &lt;diagram id=\&quot;yFu9KQ4gG2k8JNz0aPXF\&quot; name=\&quot;第 1 页\&quot;&gt;\n    &lt;mxGraphModel dx=\&quot;2390\&quot; dy=\&quot;1593\&quot; grid=\&quot;1\&quot; gridSize=\&quot;10\&quot; guides=\&quot;1\&quot; tooltips=\&quot;1\&quot; connect=\&quot;1\&quot; arrows=\&quot;1\&quot; fold=\&quot;1\&quot; page=\&quot;1\&quot; pageScale=\&quot;1\&quot; pageWidth=\&quot;1169\&quot; pageHeight=\&quot;827\&quot; math=\&quot;0\&quot; shadow=\&quot;0\&quot;&gt;\n      &lt;root&gt;\n        &lt;mxCell id=\&quot;0\&quot; /&gt;\n        &lt;mxCell id=\&quot;1\&quot; parent=\&quot;0\&quot; /&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-3\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;Lm7b8rbw1YD7ykU0n777-1\&quot; target=\&quot;Lm7b8rbw1YD7ykU0n777-2\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-1\&quot; value=\&quot;初始状态：&amp;lt;br&amp;gt;电容组电压为0\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;60\&quot; y=\&quot;255\&quot; width=\&quot;130\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-5\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;Lm7b8rbw1YD7ykU0n777-2\&quot; target=\&quot;Lm7b8rbw1YD7ykU0n777-4\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-9\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;Lm7b8rbw1YD7ykU0n777-2\&quot; target=\&quot;Lm7b8rbw1YD7ykU0n777-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-11\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;Lm7b8rbw1YD7ykU0n777-2\&quot; target=\&quot;Lm7b8rbw1YD7ykU0n777-10\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-2\&quot; value=\&quot;软启动启动：&amp;lt;br&amp;gt;持续给电容充电，&amp;lt;br&amp;gt;直至充电电流为12A\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;260\&quot; y=\&quot;250\&quot; width=\&quot;130\&quot; height=\&quot;70\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-4\&quot; value=\&quot;在这个过程中，使用5mS定时器中断循环增加占空比最小值&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;软启动指标：&amp;lt;br&amp;gt;启动速度&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;参数设定：&amp;lt;br&amp;gt;5mS定时器200Hz&amp;lt;br&amp;gt;如果想要在100mS内完成软启动，占空比参数步进次数20次，步进长度为0.95/20&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;在此期间内，充电功率不能超过预测的富余功率，充电电流\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;228.12\&quot; y=\&quot;380\&quot; width=\&quot;193.75\&quot; height=\&quot;315\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-8\&quot; value=\&quot;状态判断依据：&amp;lt;br&amp;gt;每次开发板上电执行程序前延时1s启动工作状态，上电初始状态目标占空比为最小占空比\&quot; style=\&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;220\&quot; y=\&quot;80\&quot; width=\&quot;210\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-27\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;Lm7b8rbw1YD7ykU0n777-10\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-26\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-30\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;Lm7b8rbw1YD7ykU0n777-10\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-29\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-34\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;Lm7b8rbw1YD7ykU0n777-10\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-33\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;Lm7b8rbw1YD7ykU0n777-10\&quot; value=\&quot;恒功率Buck充电：&amp;lt;br&amp;gt;使用恒定功率给电容充电\&quot; style=\&quot;whiteSpace=wrap;html=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;480\&quot; y=\&quot;255\&quot; width=\&quot;160\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;qtiTzTZJugckQutX7Err-1\&quot; value=\&quot;&amp;lt;h1&amp;gt;状态信息&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;因为电容组设置的问题，我使用的电容组满电电压为2.65*9=23.85V，也就是说：&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;1.在充电情况下，电路只工作在Buck&amp;amp;amp;Buck-Boost模式；&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;&amp;lt;span style=&amp;quot;background-color: initial;&amp;quot;&amp;gt;2.在放电状态下，电路只工作在Buck-Boost&amp;amp;amp;Boost模式。&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;触发工作组台转换电压设定为电容电压21V&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;228.12\&quot; y=\&quot;860\&quot; width=\&quot;350\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-1\&quot; value=\&quot;&amp;lt;h1&amp;gt;一些思考&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;&amp;lt;br&amp;gt;&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;10\&quot; y=\&quot;10\&quot; width=\&quot;170\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;dgB2dKaMz7UNd6GbIBNl-7\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-2\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-4\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;280\&quot; y=\&quot;1236\&quot; /&gt;\n              &lt;mxPoint x=\&quot;280\&quot; y=\&quot;1136\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-2\&quot; value=\&quot;P功率环PID\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;60\&quot; y=\&quot;1201\&quot; width=\&quot;130\&quot; height=\&quot;70\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-3\&quot; value=\&quot;&amp;lt;h1&amp;gt;PID闭环结构&amp;lt;/h1&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;20\&quot; y=\&quot;860\&quot; width=\&quot;180\&quot; height=\&quot;50\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-9\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-4\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-4\&quot; value=\&quot;固定目标电压&amp;lt;br&amp;gt;V电压环PID&amp;lt;br&amp;gt;典型目标电压值20V\&quot; style=\&quot;whiteSpace=wrap;html=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;495\&quot; y=\&quot;1106\&quot; width=\&quot;160\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-10\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-6\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-6\&quot; value=\&quot;软启动目标电流可变&amp;lt;br&amp;gt;I电流环PID&amp;lt;br&amp;gt;典型目标电流值10A\&quot; style=\&quot;whiteSpace=wrap;html=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;620\&quot; y=\&quot;1306\&quot; width=\&quot;160\&quot; height=\&quot;70\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-12\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-8\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-11\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-8\&quot; value=\&quot;Min\&quot; style=\&quot;shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;790\&quot; y=\&quot;1206\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-11\&quot; value=\&quot;pwm占空比换算&amp;lt;br&amp;gt;执行占空比更新\&quot; style=\&quot;whiteSpace=wrap;html=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;995\&quot; y=\&quot;1206\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-26\&quot; value=\&quot;恒压恒流Buck输出模式，但是输出电流目标值随着目标功率的变化发生变化，目标功率的产生方式如下图的功率PID输出；&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;在这个模式中需要有输出过流保护，输出过压保护（过压保护应该可以不加，后续看算力是否足够）&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;此时右侧半桥占空比100%输出，一定得输出100%占空比，否则下桥可能会导通\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;460\&quot; y=\&quot;380\&quot; width=\&quot;200\&quot; height=\&quot;315\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-28\&quot; value=\&quot;&amp;lt;h1&amp;gt;调整信息&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;多环PID结构需要先单独调试每一个PID，使得每一个PID环均趋于稳定后在进行串并联，预计使用simulink进行PID调整仿真&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;明确每一级的PID输出参数反应的变化量，以及输出可能具有的量纲，明确每一路PID闭环都具有实际的电路意义，避免出现无谓的算力消耗&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;如何将PID的输出值转换为pwm占空比，如何在不同工作状态下平滑的切换是一个难点&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;610\&quot; y=\&quot;860\&quot; width=\&quot;495\&quot; height=\&quot;170\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-29\&quot; value=\&quot;状态判断依据：&amp;lt;br&amp;gt;系统完成软启动过程，&amp;lt;br&amp;gt;不处于错误状态（软启动状态，输出过流过压），电容电压范围在0~0.8Vin\&quot; style=\&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;450\&quot; y=\&quot;80\&quot; width=\&quot;220\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-36\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-33\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-35\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-38\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-33\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-37\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;dgB2dKaMz7UNd6GbIBNl-2\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-33\&quot; target=\&quot;dgB2dKaMz7UNd6GbIBNl-1\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-33\&quot; value=\&quot;恒功率Buck-Boost充电：&amp;lt;br&amp;gt;使用恒定功率给电容充电\&quot; style=\&quot;whiteSpace=wrap;html=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;720\&quot; y=\&quot;255\&quot; width=\&quot;160\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-35\&quot; value=\&quot;恒压恒流输出Buck-Boost模式，输出电流目标值会锁着目标功率的变化发生变化&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;这个模式中需要有输出过流保护，输出过压保护&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;怎么实现恒功率Buck充电到恒功率Buck-Boost充电两个状态之间的平滑切换是重点\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;700\&quot; y=\&quot;380\&quot; width=\&quot;200\&quot; height=\&quot;320\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;TgtY1QW-GHyN9tbgkfsc-37\&quot; value=\&quot;状态判断依据：&amp;lt;br&amp;gt;系统正常工作，不处于错误状态（软启动状态，输出过流过压）状态，电容电压大于0.85Vin\&quot; style=\&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;690\&quot; y=\&quot;80\&quot; width=\&quot;220\&quot; height=\&quot;110\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-5\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-1\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-4\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-7\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-1\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-6\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-1\&quot; value=\&quot;状态机标识位\&quot; style=\&quot;rhombus;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1631\&quot; y=\&quot;980\&quot; width=\&quot;246\&quot; height=\&quot;100\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-9\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-4\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-8\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-11\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-4\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-10\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-4\&quot; value=\&quot;正向\&quot; style=\&quot;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1500\&quot; y=\&quot;1181\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-13\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-6\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-12\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-15\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-6\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-14\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-6\&quot; value=\&quot;负向\&quot; style=\&quot;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1900\&quot; y=\&quot;1181\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-16\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;shape=link;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-8\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-12\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-18\&quot; value=\&quot;同种工作组态\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;LoIWRr3-c8SYo3TgUJld-16\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;-0.1748\&quot; y=\&quot;-6\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;9\&quot; as=\&quot;offset\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-8\&quot; value=\&quot;buck-boost\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1631\&quot; y=\&quot;1316\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-17\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;shape=link;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-10\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-14\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;1430\&quot; y=\&quot;1430\&quot; /&gt;\n              &lt;mxPoint x=\&quot;2090\&quot; y=\&quot;1430\&quot; /&gt;\n            &lt;/Array&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-19\&quot; value=\&quot;同种工作组态\&quot; style=\&quot;edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];\&quot; parent=\&quot;LoIWRr3-c8SYo3TgUJld-17\&quot; vertex=\&quot;1\&quot; connectable=\&quot;0\&quot;&gt;\n          &lt;mxGeometry x=\&quot;0.1246\&quot; y=\&quot;-3\&quot; relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;-54\&quot; as=\&quot;offset\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-10\&quot; value=\&quot;buck\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1370\&quot; y=\&quot;1316\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-12\&quot; value=\&quot;buck-boost\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1770\&quot; y=\&quot;1316\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-14\&quot; value=\&quot;boost\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;2030\&quot; y=\&quot;1316\&quot; width=\&quot;120\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;dgB2dKaMz7UNd6GbIBNl-3\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-21\&quot; target=\&quot;dgB2dKaMz7UNd6GbIBNl-1\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-21\&quot; value=\&quot;初始状态：&amp;lt;br&amp;gt;电容组电压为0\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1329\&quot; y=\&quot;255\&quot; width=\&quot;130\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-22\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-25\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-26\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-23\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-25\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-27\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-45\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-25\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-21\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-25\&quot; value=\&quot;软启动启动：&amp;lt;br&amp;gt;持续给电容充电，&amp;lt;br&amp;gt;直至充电电流为12A\&quot; style=\&quot;rounded=1;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1529\&quot; y=\&quot;250\&quot; width=\&quot;130\&quot; height=\&quot;70\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-26\&quot; value=\&quot;在这个过程中，使用5mS定时器中断循环增加占空比最小值&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;软启动指标：&amp;lt;br&amp;gt;启动速度&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;参数设定：&amp;lt;br&amp;gt;5mS定时器200Hz&amp;lt;br&amp;gt;如果想要在100mS内完成软启动，占空比参数步进次数20次，步进长度为0.95/20&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;在此期间内，充电功率不能超过预测的富余功率，充电电流\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1497.12\&quot; y=\&quot;380\&quot; width=\&quot;193.75\&quot; height=\&quot;315\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-27\&quot; value=\&quot;状态判断依据：&amp;lt;br&amp;gt;每次开发板上电执行程序前延时1s启动工作状态，上电初始状态目标占空比为最小占空比\&quot; style=\&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1489\&quot; y=\&quot;80\&quot; width=\&quot;210\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-28\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-31\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-32\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-29\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-31\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-33\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-44\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-31\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-25\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-31\&quot; value=\&quot;恒功率Boost放电：&amp;lt;br&amp;gt;使用恒定功率从电容放电\&quot; style=\&quot;whiteSpace=wrap;html=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1749\&quot; y=\&quot;255\&quot; width=\&quot;160\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-32\&quot; value=\&quot;恒压恒流Buck输出模式，但是输出电流目标值随着目标功率的变化发生变化，目标功率的产生方式如下图的功率PID输出；&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;在这个模式中需要有输出过流保护，输出过压保护（过压保护应该可以不加，后续看算力是否足够）&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;此时右侧半桥占空比100%输出，一定得输出100%占空比，否则下桥可能会导通\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1729\&quot; y=\&quot;380\&quot; width=\&quot;200\&quot; height=\&quot;315\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-33\&quot; value=\&quot;状态判断依据：&amp;lt;br&amp;gt;系统完成软启动过程，&amp;lt;br&amp;gt;不处于错误状态（软启动状态，输出过流过压），电容电压范围在0~0.8Vin\&quot; style=\&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1719\&quot; y=\&quot;80\&quot; width=\&quot;220\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-34\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-36\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-37\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-35\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-36\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-38\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-43\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;LoIWRr3-c8SYo3TgUJld-36\&quot; target=\&quot;LoIWRr3-c8SYo3TgUJld-31\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-36\&quot; value=\&quot;恒功率Buck-Boost放电：&amp;lt;br&amp;gt;使用恒定功率从电容放电\&quot; style=\&quot;whiteSpace=wrap;html=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1989\&quot; y=\&quot;255\&quot; width=\&quot;160\&quot; height=\&quot;60\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-37\&quot; value=\&quot;恒压恒流输出Buck-Boost模式，输出电流目标值会锁着目标功率的变化发生变化&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;这个模式中需要有输出过流保护，输出过压保护&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;怎么实现恒功率Buck充电到恒功率Buck-Boost充电两个状态之间的平滑切换是重点\&quot; style=\&quot;shape=process;whiteSpace=wrap;html=1;backgroundOutline=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1969\&quot; y=\&quot;380\&quot; width=\&quot;200\&quot; height=\&quot;310\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-38\&quot; value=\&quot;状态判断依据：&amp;lt;br&amp;gt;系统正常工作，不处于错误状态（软启动状态，输出过流过压）状态，电容电压大于0.85Vin\&quot; style=\&quot;shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1959\&quot; y=\&quot;85\&quot; width=\&quot;220\&quot; height=\&quot;110\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;LoIWRr3-c8SYo3TgUJld-39\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;shape=link;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-35\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-35\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;dgB2dKaMz7UNd6GbIBNl-1\&quot; value=\&quot;充放电其实是就是互相的逆过程&amp;lt;br&amp;gt;只需要明确电路工作时电流的流向即可&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;放电时电容流向电池，充电时电池流向电容，如何确保电流流向的正确，并且*安全*的完成电流的换向是一个难点\&quot; style=\&quot;ellipse;whiteSpace=wrap;html=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1050\&quot; y=\&quot;217.5\&quot; width=\&quot;225\&quot; height=\&quot;135\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;dgB2dKaMz7UNd6GbIBNl-4\&quot; value=\&quot;&amp;lt;h1&amp;gt;状态转换&amp;lt;/h1&amp;gt;&amp;lt;p&amp;gt;状态转换的过程均在5mS的中断里头完成，HRTIM中断只进行PID的计算和PWM占空比的更新，重要的是5mS中断里头的函数&amp;lt;/p&amp;gt;\&quot; style=\&quot;text;html=1;strokeColor=none;fillColor=none;spacing=5;spacingTop=-20;whiteSpace=wrap;overflow=hidden;rounded=0;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;1210\&quot; y=\&quot;870\&quot; width=\&quot;190\&quot; height=\&quot;120\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;tSdqgkAIaKh0-t4PPUWu-1\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;endArrow=none;\&quot; parent=\&quot;1\&quot; source=\&quot;TgtY1QW-GHyN9tbgkfsc-2\&quot; target=\&quot;dgB2dKaMz7UNd6GbIBNl-5\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot;&gt;\n            &lt;mxPoint x=\&quot;495\&quot; y=\&quot;1341\&quot; as=\&quot;targetPoint\&quot; /&gt;\n            &lt;Array as=\&quot;points\&quot;&gt;\n              &lt;mxPoint x=\&quot;280\&quot; y=\&quot;1236\&quot; /&gt;\n              &lt;mxPoint x=\&quot;280\&quot; y=\&quot;1341\&quot; /&gt;\n            &lt;/Array&gt;\n            &lt;mxPoint x=\&quot;190\&quot; y=\&quot;1236\&quot; as=\&quot;sourcePoint\&quot; /&gt;\n          &lt;/mxGeometry&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;tSdqgkAIaKh0-t4PPUWu-2\&quot; value=\&quot;\&quot; style=\&quot;edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;\&quot; parent=\&quot;1\&quot; source=\&quot;dgB2dKaMz7UNd6GbIBNl-5\&quot; target=\&quot;TgtY1QW-GHyN9tbgkfsc-6\&quot; edge=\&quot;1\&quot;&gt;\n          &lt;mxGeometry relative=\&quot;1\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n        &lt;mxCell id=\&quot;dgB2dKaMz7UNd6GbIBNl-5\&quot; value=\&quot;富余功率目标功率可变&amp;lt;br&amp;gt;P功率环PID&amp;lt;br&amp;gt;典型目标功率65W\&quot; style=\&quot;whiteSpace=wrap;html=1;rounded=1;\&quot; parent=\&quot;1\&quot; vertex=\&quot;1\&quot;&gt;\n          &lt;mxGeometry x=\&quot;370\&quot; y=\&quot;1306\&quot; width=\&quot;160\&quot; height=\&quot;70\&quot; as=\&quot;geometry\&quot; /&gt;\n        &lt;/mxCell&gt;\n      &lt;/root&gt;\n    &lt;/mxGraphModel&gt;\n  &lt;/diagram&gt;\n&lt;/mxfile&gt;\n&quot;}"></div>
<script type="text/javascript" src="https://viewer.diagrams.net/js/viewer-static.min.js"></script>
</body>
</html>